# –û –ø—Ä–æ–µ–∫—Ç–µ

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–∏–≥–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–æ–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–∞—Å—á–µ—Ç–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–æ–¥–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–¥—É–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ç–æ–∫ –≤—ã–¥–µ–ª–µ–Ω –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–∫–∂–µ –∏ –≤ –≤–∏–¥–µ CLI-—É—Ç–∏–ª–∏—Ç—ã

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ Procfile:

```bash
gem install foreman
```

–¢–∞–∫–∂–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã celery –Ω—É–∂–µ–Ω Redis. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–æ [–≥–∞–π–¥—É –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Redis](https://redis.io/docs/latest/operate/oss_and_stack/install/install-redis/)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

## CLI-—É—Ç–∏–ª–∏—Ç–∞

```bash
python generate_mesh.py [–æ–ø—Ü–∏–∏]
```

### ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä               | –û–ø–∏—Å–∞–Ω–∏–µ                                      | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é            |
|------------------------|-----------------------------------------------|--------------------------|
| `--r-root`             | –†–∞–¥–∏—É—Å –∫–æ—Ä–Ω—è                                  | `0.5`                    |
| `--h-root`             | –í—ã—Å–æ—Ç–∞ –∫–æ—Ä–Ω—è                                  | `4.0`                    |
| `--r-branch`           | –†–∞–¥–∏—É—Å –≤–µ—Ç–≤–µ–π                                 | `0.4`                    |
| `--h-branch`           | –í—ã—Å–æ—Ç–∞ –≤–µ—Ç–≤–µ–π                                 | `3.0`                    |
| `--num-branches`       | –ö–æ–ª-–≤–æ –≤–µ—Ç–≤–µ–π                                 | `4`                      |
| `--angle`              | –£–≥–æ–ª –º–µ–∂–¥—É –≤–µ—Ç–≤—è–º–∏ (–≤ –≥—Ä–∞–¥—É—Å–∞—Ö)               | `30`                     |
| `--mesh-size`          | –†–∞–∑–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–µ—Ç–∫–∏                        | `1.0`                    |
| `--output`             | –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ `.msh` —Ñ–∞–π–ª–∞                    | `branch_element.msh`     |
| `--export-formats`     | –≠–∫—Å–ø–æ—Ä—Ç –≤ –¥–æ–ø. —Ñ–æ—Ä–º–∞—Ç—ã (`stl,obj,vtk,...`)    | _–Ω–µ —É–∫–∞–∑–∞–Ω–æ_             |
| `--no-gui`             | –ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å GUI Gmsh                         | _false_                  |
| `--log-file`           | –ü—É—Ç—å –∫ –ª–æ–≥-—Ñ–∞–π–ª—É                              | _–Ω–µ —É–∫–∞–∑–∞–Ω–æ_             |
| `--config`             | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª `.yaml` –∏–ª–∏ `.json`    | _–Ω–µ —É–∫–∞–∑–∞–Ω–æ_             |


### üìù –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (config.yaml)

```yaml
r_root: 0.6
h_root: 5.0
num_branches: 6
angle: 25
mesh_size: 0.8
output: "cool_branch.msh"
export_formats: "stl,obj"
no_gui: true
log_file: "generation.log"
```

### üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞

#### –ó–∞–ø—É—Å–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
```bash
python generate_mesh.py --r-root 0.6 --num-branches 6 --angle 45 --no-gui --output result.msh
```

#### –ó–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:
```bash
python generate_mesh.py --config config.yaml
```

## –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å

> `localhost:8080/docs` - API-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è HTTP-—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ç–æ–∫

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–æ–∫–µ–Ω—É –≤ —Ö–µ–¥–µ—Ä–µ API-KEY, –ø–æ—ç—Ç–æ–º—É –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–ª—è—Ç—å —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –≤–æ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã.
–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è API_KEY, –ø–æ—ç—Ç–æ–º—É –µ—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

–ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å docker-compose —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏. –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π API-KEY –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ `123` (–ø–æ–º–µ–Ω—è—Ç—å –¥–ª—è production !)
```bash
docker-compose up
```

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å webhook, –º–æ–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å test_webhook —Å–µ—Ä–≤–µ—Ä(—Ç—É—Ç –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ Docker –Ω–µ –Ω–∞–ª–∞–∂–µ–Ω –ø–æ–∫–∞):

```bash
python -m uvicorn test_webhook:app --reload --port=8001
```

–¢–æ–≥–¥–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ `/generate` –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å webhook_url: http://localhost:8001/webhook

### –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker

#### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ foreman

–ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `foreman`, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑

```bash
API_KEY=<–≤–∞—à –∫–ª—é—á> foreman start
```

#### –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥ –≤—Ä—É—á–Ω—É—é
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∏—Ö –ø–æ –æ–¥–Ω–æ–º—É:

1. –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

```bash
API_KEY=<–≤–∞—à –∫–ª—é—á> python -m uvicorn main:app --reload
```

2. –ó–∞–ø—É—Å–∫ celery

```bash
celery -A tasks.celery_app worker --loglevel=info
```

3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –≤–µ–±-—Ö—É–∫–∞ –Ω–∞ –ø–æ—Ä—Ç—É 8001

```bash
python -m uvicorn test_webhook:app --reload --port=8001
```

